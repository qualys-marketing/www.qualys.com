{"version":3,"sources":["../../../site/pages/asset/script/local-time-with-moment.js"],"names":["moment","fn","document","readyState","addEventListener","elements","querySelectorAll","index","length","element","datetime","getAttribute","format","locale","navigator","languages","m","innerText","lang","substr","setAttribute"],"mappings":"aAAA,mB,CAEA;;GAGC,UAAUA,CAAV,CAAkB,CAElB,aAEA;AASA;AACA,CATA,SAAeC,CAAf,CAAmB,CACU,SAAxB,GAAAC,QAAQ,CAACC,UADK,CAIjBD,QAAQ,CAACE,gBAAT,CAA0B,kBAA1B,CAA8CH,CAA9C,CAJiB,CAEjBA,CAAE,EAIH,CAGD,EAAM,UAAY,CAEjB,GAAKD,CAAL,CAEC;AAFD,CAOA;AACA;AACA,GAAMK,CAAAA,CAAQ,CAAGH,QAAQ,CAACI,gBAAT,CAA0B,6BAA1B,CAAjB,CAEA,GAAID,CAAJ,CAEC,IAAK,GAAIE,CAAAA,CAAK,CAAG,CAAZ,CAAeC,CAAM,CAAGH,CAAQ,CAACG,MAAtC,CAA8CD,CAAK,CAAGC,CAAtD,CAA8DD,CAAK,EAAI,CAAvE,CAA0E,CAEzE;AAFyE,GAGnEE,CAAAA,CAAO,CAAGJ,CAAQ,CAACE,CAAD,CAHiD,CAInEG,CAAQ,CAAGD,CAAO,CAACE,YAAR,CAAqB,UAArB,CAJwD,CAKnEC,CAAM,CAAGH,CAAO,CAACE,YAAR,CAAqB,aAArB,CAL0D,CAMrEE,CAAM,CAAGJ,CAAO,CAACE,YAAR,CAAqB,QAArB,CAN4D,CAmBzE,GAXKE,CAWL,GARKC,SAAS,CAACC,SAAV,EAAoD,CAA7B,CAAAD,SAAS,CAACC,SAAV,CAAoBP,MAQhD,CAPEK,CAAM,CAAGC,SAAS,CAACC,SAAV,CAAoB,CAApB,CAOX,CALEF,CAAM,CAAG,IAKX,EAAIH,CAAQ,EAAIE,CAAhB,CAAwB,CAEvB;AACA,GAAMI,CAAAA,CAAC,CAAGhB,CAAM,CAACU,CAAD,CAAhB,CACAM,CAAC,CAACH,MAAF,CAASA,CAAT,CAJuB,CAKvBJ,CAAO,CAACQ,SAAR,CAAoBD,CAAC,CAACJ,MAAF,CAASA,CAAT,CALG,CAOvB;AACA;AACA,GAAMM,CAAAA,CAAI,CAAGL,CAAM,CAACM,MAAP,CAAc,CAAd,CAAiB,CAAjB,CAAb,CACAV,CAAO,CAACW,YAAR,CAAqB,MAArB,CAA6BF,CAA7B,CAEA,CAED,CA9CF,CAkDA,CApDD,CAsDA,CApEA,EAoEClB,MApED,C","sourcesContent":["/* global moment */\n\n/*\n * change all time tags (with datetime attributes) to the visitors local time\n */\n(function (moment) {\n\n\t\"use strict\";\n\n\t// helper function\n\tfunction ready(fn) {\n\t\tif (document.readyState !== \"loading\"){\n\t\t\tfn();\n\t\t} else {\n\t\t\tdocument.addEventListener(\"DOMContentLoaded\", fn);\n\t\t}\n\t}\n\n\t// wait for the document to be ready\n\tready(function () {\n\n\t\tif (!moment) {\n\n\t\t\t// if moment is not loaded, then don't bother\n\t\t\treturn;\n\n\t\t}\n\n\t\t// find all time tags with datetime attributes\n\t\t// and data-format attributes\n\t\tconst elements = document.querySelectorAll(\"time[datetime][data-format]\");\n\n\t\tif (elements) {\n\n\t\t\tfor (let index = 0, length = elements.length; index < length; index += 1) {\n\n\t\t\t\t// process each element found\n\t\t\t\tconst element = elements[index];\n\t\t\t\tconst datetime = element.getAttribute(\"datetime\");\n\t\t\t\tconst format = element.getAttribute(\"data-format\");\n\t\t\t\tlet locale = element.getAttribute(\"locale\");\n\n\t\t\t\tif (!locale) {\n\n\t\t\t\t\t// TODO ask browser for visitors preferred locale\n\t\t\t\t\tif (navigator.languages && navigator.languages.length > 0) {\n\t\t\t\t\t\tlocale = navigator.languages[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlocale = \"en\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (datetime && format) {\n\n\t\t\t\t\t// replace contents with local time formatted by moment.js\n\t\t\t\t\tconst m = moment(datetime);\n\t\t\t\t\tm.locale(locale);\n\t\t\t\t\telement.innerText = m.format(format);\n\n\t\t\t\t\t// add lang attribute\n\t\t\t\t\t// since moment will use the language matching the locale\n\t\t\t\t\tconst lang = locale.substr(0, 2);\n\t\t\t\t\telement.setAttribute(\"lang\", lang);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t});\n\n}(moment));\n"],"file":"local-time-with-moment.js"}